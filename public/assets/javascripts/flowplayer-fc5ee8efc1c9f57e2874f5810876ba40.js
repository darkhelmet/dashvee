/* 
 * flowplayer.js 3.1.4. The Flowplayer API
 * 
 * Copyright 2009 Flowplayer Oy
 * 
 * This file is part of Flowplayer.
 * 
 * Flowplayer is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 * 
 * Flowplayer is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 * 
 * You should have received a copy of the GNU General Public License
 * along with Flowplayer.  If not, see <http://www.gnu.org/licenses/>.
 * 
 * Date: 2009-02-25 21:24:29 +0000 (Wed, 25 Feb 2009)
 * Revision: 166 
 */
(function(){function e(e){console.log("$f.fireEvent",[].slice.call(e))}function t(e){if(!e||typeof e!="object")return e;var n=new e.constructor;for(var r in e)e.hasOwnProperty(r)&&(n[r]=t(e[r]));return n}function n(e,t){if(!e)return;var n,r=0,i=e.length;if(i===undefined){for(n in e)if(t.call(e[n],n,e[n])===!1)break}else for(var s=e[0];r<i&&t.call(s,r,s)!==!1;s=e[++r]);return e}function r(e){return document.getElementById(e)}function i(e,t,r){return typeof t!="object"?e:(e&&t&&n(t,function(t,n){if(!r||typeof n!="function")e[t]=n}),e)}function s(e){var t=e.indexOf(".");if(t!=-1){var r=e.substring(0,t)||"*",i=e.substring(t+1,e.length),s=[];return n(document.getElementsByTagName(r),function(){this.className&&this.className.indexOf(i)!=-1&&s.push(this)}),s}}function o(e){return e=e||window.event,e.preventDefault?(e.stopPropagation(),e.preventDefault()):(e.returnValue=!1,e.cancelBubble=!0),!1}function u(e,t,n){e[t]=e[t]||[],e[t].push(n)}function a(){return"_"+(""+Math.random()).substring(2,10)}function c(s,c,p){function O(){function t(e){return!d.isLoaded()&&d._fireEvent("onBeforeClick")!==!1&&d.load(),o(e)}$f(s)?($f(s).getParent().innerHTML="",N=$f(s).getIndex(),h[N]=d):(h.push(d),N=h.length-1),A=parseInt(s.style.height,10)||s.clientHeight,typeof c=="string"&&(c={src:c}),x=s.id||"fp"+a(),T=c.id||x+"_api",c.id=T,p.playerId=x,typeof p=="string"&&(p={clip:{url:p}}),typeof p.clip=="string"&&(p.clip={url:p.clip}),p.clip=p.clip||{},s.getAttribute("href",2)&&!p.clip.url&&(p.clip.url=s.getAttribute("href",2)),b=new f(p.clip,-1,d),p.playlist=p.playlist||[p.clip];var e=0;n(p.playlist,function(){var t=this;typeof t=="object"&&t.length&&(t={url:""+t}),n(p.clip,function(e,n){n!==undefined&&t[e]===undefined&&typeof n!="function"&&(t[e]=n)}),p.playlist[e]=t,t=new f(t,e,d),w.push(t),e++}),n(p,function(e,t){typeof t=="function"&&(b[e]?b[e](t):u(S,e,t),delete p[e])}),n(p.plugins,function(e,t){t&&(E[e]=new l(e,t,d))});if(!p.plugins||p.plugins.controls===undefined)E.controls=new l("controls",null,d);E.canvas=new l("canvas",null,d),c.bgcolor=c.bgcolor||"#000000",c.version=c.version||[9,0],c.expressInstall="http://www.flowplayer.org/swf/expressinstall.swf",y=s.innerHTML,y.replace(/\s/g,"")!==""?s.addEventListener?s.addEventListener("click",t,!1):s.attachEvent&&s.attachEvent("onclick",t):(s.addEventListener&&s.addEventListener("click",o,!1),d.load())}var d=this,v=null,y,b,w=[],E={},S={},x,T,N,C,L,A;i(d,{id:function(){return x},isLoaded:function(){return v!==null},getParent:function(){return s},hide:function(e){return e&&(s.style.height="0px"),v&&(v.style.height="0px"),d},show:function(){return s.style.height=A+"px",v&&(v.style.height=L+"px"),d},isHidden:function(){return v&&parseInt(v.style.height,10)===0},load:function(e){return!v&&d._fireEvent("onBeforeLoad")!==!1&&(n(h,function(){this.unload()}),y=s.innerHTML,y&&!flashembed.isSupported(c.version)&&(s.innerHTML=""),flashembed(s,c,{config:p}),e&&(e.cached=!0,u(S,"onLoad",e))),d},unload:function(){if(y.replace(/\s/g,"")!==""){if(d._fireEvent("onBeforeUnload")===!1)return d;try{v&&(v.fp_close(),d._fireEvent("onUnload"))}catch(e){}v=null,s.innerHTML=y}return d},getClip:function(e){return e===undefined&&(e=C),w[e]},getCommonClip:function(){return b},getPlaylist:function(){return w},getPlugin:function(e){var t=E[e];if(!t&&d.isLoaded()){var n=d._api().fp_getPlugin(e);n&&(t=new l(e,n,d),E[e]=t)}return t},getScreen:function(){return d.getPlugin("screen")},getControls:function(){return d.getPlugin("controls")},getConfig:function(e){return e?t(p):p},getFlashParams:function(){return c},loadPlugin:function(e,t,n,r){typeof n=="function"&&(r=n,n={});var i=r?a():"_";d._api().fp_loadPlugin(e,t,n,i);var s={};s[i]=r;var o=new l(e,null,d,s);return E[e]=o,o},getState:function(){return v?v.fp_getState():-1},play:function(e,t){function n(){e!==undefined?d._api().fp_play(e,t):d._api().fp_play()}return v?n():d.load(function(){n()}),d},getVersion:function(){var e="flowplayer.js 3.1.4";if(v){var t=v.fp_getVersion();return t.push(e),t}return e},_api:function(){if(!v)throw"Flowplayer "+d.id()+" not loaded when calling an API method";return v},setClip:function(e){return d.setPlaylist([e]),d},getIndex:function(){return N}}),n("Click*,Load*,Unload*,Keypress*,Volume*,Mute*,Unmute*,PlaylistReplace,ClipAdd,Fullscreen*,FullscreenExit,Error,MouseOver,MouseOut".split(","),function(){var e="on"+this;if(e.indexOf("*")!=-1){e=e.substring(0,e.length-1);var t="onBefore"+e.substring(2);d[t]=function(e){return u(S,t,e),d}}d[e]=function(t){return u(S,e,t),d}}),n("pause,resume,mute,unmute,stop,toggle,seek,getStatus,getVolume,setVolume,getTime,isPaused,isPlaying,startBuffering,stopBuffering,isFullscreen,toggleFullscreen,reset,close,setPlaylist,addClip,playFeed".split(","),function(){var e=this;d[e]=function(t,n){if(!v)return d;var r=null;return t!==undefined&&n!==undefined?r=v["fp_"+e](t,n):r=t===undefined?v["fp_"+e]():v["fp_"+e](t),r==="undefined"||r===undefined?d:r}}),d._fireEvent=function(t){typeof t=="string"&&(t=[t]);var i=t[0],s=t[1],o=t[2],u=t[3],a=0;p.debug&&e(t),!v&&i=="onLoad"&&s=="player"&&(v=v||r(T),L=v.clientHeight,n(w,function(){this._fireEvent("onLoad")}),n(E,function(e,t){t._fireEvent("onUpdate")}),b._fireEvent("onLoad"));if(i=="onLoad"&&s!="player")return;i=="onError"&&(typeof s=="string"||typeof s=="number"&&typeof o=="number")&&(s=o,o=u);if(i=="onContextMenu"){n(p.contextMenu[s],function(e,t){t.call(d)});return}if(i=="onPluginEvent"){var l=s.name||s,c=E[l];c&&(c._fireEvent("onUpdate",s),c._fireEvent(o,t.slice(3)));return}if(i=="onPlaylistReplace"){w=[];var h=0;n(s,function(){w.push(new f(this,h++,d))})}if(i=="onClipAdd"){if(s.isInStream)return;s=new f(s,o,d),w.splice(o,0,s);for(a=o+1;a<w.length;a++)w[a].index++}var y=!0;if(typeof s=="number"&&s<w.length){C=s;var x=w[s];x&&(y=x._fireEvent(i,o,u));if(!x||y!==!1)y=b._fireEvent(i,o,u,x)}return n(S[i],function(){y=this.call(d,s,o),this.cached&&S[i].splice(a,1);if(y===!1)return!1;a++}),y},typeof s=="string"?flashembed.domReady(function(){var e=r(s);if(!e)throw"Flowplayer cannot access element: "+s;s=e,O()}):O()}function p(e){this.length=e.length,this.each=function(t){n(e,t)},this.size=function(){return e.length}}var f=function(e,t,r){var s=this,o={},f={};s.index=t,typeof e=="string"&&(e={url:e}),i(this,e,!0),n("Begin*,Start,Pause*,Resume*,Seek*,Stop*,Finish*,LastSecond,Update,BufferFull,BufferEmpty,BufferStop".split(","),function(){var e="on"+this;if(e.indexOf("*")!=-1){e=e.substring(0,e.length-1);var n="onBefore"+e.substring(2);s[n]=function(e){return u(f,n,e),s}}s[e]=function(t){return u(f,e,t),s},t==-1&&(s[n]&&(r[n]=s[n]),s[e]&&(r[e]=s[e]))}),i(this,{onCuepoint:function(e,n){if(arguments.length==1)return o.embedded=[null,e],s;typeof e=="number"&&(e=[e]);var i=a();return o[i]=[e,n],r.isLoaded()&&r._api().fp_addCuepoints(e,t,i),s},update:function(e){i(s,e),r.isLoaded()&&r._api().fp_updateClip(e,t);var n=r.getConfig(),o=t==-1?n.clip:n.playlist[t];i(o,e,!0)},_fireEvent:function(e,u,a,l){if(e=="onLoad")return n(o,function(e,n){n[0]&&r._api().fp_addCuepoints(n[0],t,e)}),!1;l=l||s;if(e=="onCuepoint"){var c=o[u];if(c)return c[1].call(r,l,a)}u&&"onBeforeBegin,onMetaData,onStart,onUpdate,onResume".indexOf(e)!=-1&&(i(l,u),u.metaData&&(l.duration?l.fullDuration=u.metaData.duration:l.duration=u.metaData.duration));var h=!0;return n(f[e],function(){h=this.call(r,l,u,a)}),h}});if(e.onCuepoint){var l=e.onCuepoint;s.onCuepoint.apply(s,typeof l=="function"?[l]:l),delete e.onCuepoint}n(e,function(t,n){typeof n=="function"&&(u(f,t,n),delete e[t])}),t==-1&&(r.onCuepoint=this.onCuepoint)},l=function(e,t,r,s){var o={},u=this,f=!1;s&&i(o,s),n(t,function(e,n){typeof n=="function"&&(o[e]=n,delete t[e])}),i(this,{animate:function(n,i,s){if(!n)return u;typeof i=="function"&&(s=i,i=500);if(typeof n=="string"){var f=n;n={},n[f]=i,i=500}if(s){var l=a();o[l]=s}return i===undefined&&(i=500),t=r._api().fp_animate(e,n,i,l),u},css:function(n,s){if(s!==undefined){var o={};o[n]=s,n=o}return t=r._api().fp_css(e,n),i(u,t),u},show:function(){return this.display="block",r._api().fp_showPlugin(e),u},hide:function(){return this.display="none",r._api().fp_hidePlugin(e),u},toggle:function(){return this.display=r._api().fp_togglePlugin(e),u},fadeTo:function(t,n,i){typeof n=="function"&&(i=n,n=500);if(i){var s=a();o[s]=i}return this.display=r._api().fp_fadeTo(e,t,n,s),this.opacity=t,u},fadeIn:function(e,t){return u.fadeTo(1,e,t)},fadeOut:function(e,t){return u.fadeTo(0,e,t)},getName:function(){return e},getPlayer:function(){return r},_fireEvent:function(t,s,a){if(t=="onUpdate"){var l=r._api().fp_getPlugin(e);if(!l)return;i(u,l),delete u.methods,f||(n(l.methods,function(){var t=""+this;u[t]=function(){var n=[].slice.call(arguments),i=r._api().fp_invoke(e,t,n);return i==="undefined"||i===undefined?u:i}}),f=!0)}var c=o[t];c&&(c.apply(u,s),t.substring(0,1)=="_"&&delete o[t])}})},h=[];window.flowplayer=window.$f=function(){var e=null,i=arguments[0];if(!arguments.length)return n(h,function(){if(this.isLoaded())return e=this,!1}),e||h[0];if(arguments.length==1)return typeof i=="number"?h[i]:i=="*"?new p(h):(n(h,function(){if(this.id()==i.id||this.id()==i||this.getParent()==i)return e=this,!1}),e);if(arguments.length>1){var o=arguments[1],u=arguments.length==3?arguments[2]:{};if(typeof i=="string"){if(i.indexOf(".")!=-1){var a=[];return n(s(i),function(){a.push(new c(this,t(o),t(u)))}),new p(a)}var f=r(i);return new c(f!==null?f:i,o,u)}if(i)return new c(i,o,u)}return null},i(window.$f,{fireEvent:function(){var e=[].slice.call(arguments),t=$f(e[0]);return t?t._fireEvent(e.slice(1)):null},addPlugin:function(e,t){return c.prototype[e]=t,$f},each:n,extend:i}),typeof jQuery=="function"&&(jQuery.prototype.flowplayer=function(e,n){if(!arguments.length||typeof arguments[0]=="number"){var r=[];return this.each(function(){var e=$f(this);e&&r.push(e)}),arguments.length?r[arguments[0]]:new p(r)}return this.each(function(){$f(this,t(e),n?t(n):{})})})})(),function(){function n(){if(r.done)return!1;var e=document;if(e&&e.getElementsByTagName&&e.getElementById&&e.body){clearInterval(r.timer),r.timer=null;for(var t=0;t<r.ready.length;t++)r.ready[t].call();r.ready=null,r.done=!0}}function i(e,t){if(t)for(key in t)t.hasOwnProperty(key)&&(e[key]=t[key]);return e}function s(e){switch(o(e)){case"string":return e=e.replace(new RegExp('(["\\\\])',"g"),"\\$1"),e=e.replace(/^\s?(\d+)%/,"$1pct"),'"'+e+'"';case"array":return"["+u(e,function(e){return s(e)}).join(",")+"]";case"function":return'"function()"';case"object":var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push('"'+n+'":'+s(e[n]));return"{"+t.join(",")+"}"}return String(e).replace(/\s/g," ").replace(/\'/g,'"')}function o(e){if(e===null||e===undefined)return!1;var t=typeof e;return t=="object"&&e.push?"array":t}function u(e,t){var n=[];for(var r in e)e.hasOwnProperty(r)&&(n[r]=t(e[r]));return n}function a(e,t){var n=i({},e),r=document.all,o='<object width="'+n.width+'" height="'+n.height+'"';r&&!n.id&&(n.id="_"+(""+Math.random()).substring(9)),n.id&&(o+=' id="'+n.id+'"'),n.cachebusting&&(n.src+=(n.src.indexOf("?")!=-1?"&":"?")+Math.random()),n.w3c||!r?o+=' data="'+n.src+'" type="application/x-shockwave-flash"':o+=' classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"',o+=">";if(n.w3c||r)o+='<param name="movie" value="'+n.src+'" />';n.width=n.height=n.id=n.w3c=n.src=null;for(var u in n)n[u]!==null&&(o+='<param name="'+u+'" value="'+n[u]+'" />');var a="";if(t){for(var f in t)t[f]!==null&&(a+=f+"="+(typeof t[f]=="object"?s(t[f]):t[f])+"&");a=a.substring(0,a.length-1),o+='<param name="flashvars" value=\''+a+"' />"}return o+="</object>",o}function f(e,t,n){var r=flashembed.getVersion();i(this,{getContainer:function(){return e},getConf:function(){return t},getVersion:function(){return r},getFlashvars:function(){return n},getApi:function(){return e.firstChild},getHTML:function(){return a(t,n)}});var s=t.version,o=t.expressInstall,u=!s||flashembed.isSupported(s);u?(t.onFail=t.version=t.expressInstall=null,e.innerHTML=a(t,n)):s&&o&&flashembed.isSupported([6,65])?(i(t,{src:o}),n={MMredirectURL:location.href,MMplayerType:"PlugIn",MMdoctitle:document.title},e.innerHTML=a(t,n)):e.innerHTML.replace(/\s/g,"")===""&&(e.innerHTML="<h2>Flash version "+s+" or greater is required</h2><h3>"+(r[0]>0?"Your version is "+r:"You have no flash plugin installed")+"</h3>"+(e.tagName=="A"?"<p>Click here to download latest version</p>":"<p>Download latest version from <a href='http://www.adobe.com/go/getflashplayer'>here</a></p>"),e.tagName=="A"&&(e.onclick=function(){location.href="http://www.adobe.com/go/getflashplayer"}));if(!u&&t.onFail){var f=t.onFail.call(this);typeof f=="string"&&(e.innerHTML=f)}document.all&&(window[t.id]=document.getElementById(t.id))}var e=typeof jQuery=="function",t={width:"100%",height:"100%",allowfullscreen:!0,allowscriptaccess:"always",quality:"high",version:null,onFail:null,expressInstall:null,w3c:!1,cachebusting:!1};e&&(jQuery.tools=jQuery.tools||{},jQuery.tools.flashembed={version:"1.0.4",conf:t});var r=e?jQuery:function(e){if(r.done)return e();r.timer?r.ready.push(e):(r.ready=[e],r.timer=setInterval(n,13))};window.attachEvent&&window.attachEvent("onbeforeunload",function(){__flash_unloadHandler=function(){},__flash_savedUnloadHandler=function(){}}),window.flashembed=function(e,n,s){if(typeof e=="string"){var o=document.getElementById(e);if(!o){r(function(){flashembed(e,n,s)});return}e=o}if(!e)return;typeof n=="string"&&(n={src:n});var u=i({},t);return i(u,n),new f(e,u,s)},i(window.flashembed,{getVersion:function(){var e=[0,0];if(navigator.plugins&&typeof navigator.plugins["Shockwave Flash"]=="object"){var t=navigator.plugins["Shockwave Flash"].description;if(typeof t!="undefined"){t=t.replace(/^.*\s+(\S+\s+\S+$)/,"$1");var n=parseInt(t.replace(/^(.*)\..*$/,"$1"),10),r=/r/.test(t)?parseInt(t.replace(/^.*r(.*)$/,"$1"),10):0;e=[n,r]}}else if(window.ActiveXObject){try{var i=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7")}catch(s){try{i=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6"),e=[6,0],i.AllowScriptAccess="always"}catch(o){if(e[0]==6)return e}try{i=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(u){}}typeof i=="object"&&(t=i.GetVariable("$version"),typeof t!="undefined"&&(t=t.replace(/^\S+\s+(.*)$/,"$1").split(","),e=[parseInt(t[0],10),parseInt(t[2],10)]))}return e},isSupported:function(e){var t=flashembed.getVersion(),n=t[0]>e[0]||t[0]==e[0]&&t[1]>=e[1];return n},domReady:r,asString:s,getHTML:a}),e&&(jQuery.fn.flashembed=function(e,t){var n=null;return this.each(function(){n=flashembed(this,e,t)}),e.api===!1?this:n})}();